%CONVERGENCE_RATE_CHECK generate plot for analyic test problems
% IFISS scriptfile: DJS; 29 July 2022.
% Copyright (c) 2022 G. Papanikos, C.E. Powell, D.J. Silvester
close all

%------ cube domain constant source (test problem 1)
figure(1)

loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[0.148626742530367,0.075046364876659,0.037635974091263,0.018833272413076,0.009415702360345],'-','LineWidth',3);
hold on

loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[0.2541448,0.108706514872479,0.047463381521142,0.021532274959825,0.010131086735572],'-','LineWidth',3);
hold on
loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[0.1379063,0.0697723,0.0350505,0.0175613,0.0087891],'-','LineWidth',3);
hold on
loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[0.2450525,0.1080969,0.0489049,0.0228648,0.0109837],'-','LineWidth',3);
hold on
loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[0.1435903,0.0739191,0.0374577,0.0188456,0.0094504],'-','LineWidth',3);
hold on

loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[(9*9*9)^(-1/3),(17*17*17)^(-1/3),(33*33*33)^(-1/3) (65*65*65)^(-1/3),(129*129*129)^(-1/3)],'-','LineWidth',3);

legend('|e_{ref}|_A','\eta_{Q_2(h)}','\eta_{Q^r_2(h)}','\eta_{Q_1(h/2)}','\eta_{Q^r_1(h/2)}','dof^{-1/3}')
xlabel('dof')
ylabel('error')
grid on
set(gca,'FontSize',20)

%------ stair-shaped domain constant source (test problem 2)
figure(2)

% |e_{ref}|_A
loglog([9*9*9-4*4*9,17*17*17-9*9*17,33*33*33-17*17*33,65*65*65-33*33*65,129*129*129-65*65*129],[0.149663065863207, 0.078566141683815 ,0.041679823009049,0.022402254076070,0.012030436875632],'-','LineWidth',3);
hold on

% eta_Q2(h)
loglog([9*9*9-4*4*9,17*17*17-9*9*17,33*33*33-17*17*33,65*65*65-33*33*65,129*129*129-65*65*129],[0.267049, 0.123043 ,0.060260,0.032011,0.018158],'-','LineWidth',3);
hold on
%eta_Q2r(h)
loglog([9*9*9-4*4*9,17*17*17-9*9*17,33*33*33-17*17*33,65*65*65-33*33*65,129*129*129-65*65*129],[0.1325502, 0.0687429 ,0.0359079,0.0190414,0.0103096],'-','LineWidth',3);
hold on
% eta_Q1(h/2)
loglog([9*9*9-4*4*9,17*17*17-9*9*17,33*33*33-17*17*33,65*65*65-33*33*65,129*129*129-65*65*129],[0.2372404, 0.1077145 ,0.0511975, 0.0258884,0.0138730],'-','LineWidth',3);
hold on
% eta_Qr1(h/2)
loglog([9*9*9-4*4*9,17*17*17-9*9*17,33*33*33-17*17*33,65*65*65-33*33*65,129*129*129-65*65*129],[0.1256711, 0.0651946 ,0.0333126, 0.0169479,0.0086402],'-','LineWidth',3);
hold on

loglog([9*9*9-4*4*9,17*17*17-9*9*17,33*33*33-17*17*33,65*65*65-33*33*65,129*129*129-65*65*129],[(9*9*9-4*4*9)^(-1/3),(17*17*17-9*9*17)^(-1/3),(33*33*33-17*17*33)^(-1/3),(65*65*65-33*33*65)^(-1/3),(129*129*129-65*65*129)^(-1/3)],'-','LineWidth',3);

legend('|e_{ref}|_A','\eta_{Q_2(h)}','\eta_{Q^r_2(h)}','\eta_{Q_1(h/2)}','\eta_{Q^r_1(h/2)}','dof^{-1/3}')
xlabel('dof')
ylabel('error')
grid on
set(gca,'FontSize',20)

%------ cube domain triquadratic solution (test problem 12)
figure(12)

loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[0.3788442,0.1887763,0.0943077,0.0471438,0.0235706],'-','LineWidth',3);
hold on
loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[0.4657930,0.2106518,0.0997873,0.0485151,0.0239136],'-','LineWidth',3);
hold on
loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[0.3671824,0.1831976,0.0915604,0.0457812,0.0228924],'-','LineWidth',3);
hold on
loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[0.5350458,0.2514302,0.1219639,0.0600899,0.0298283],'-','LineWidth',3);
hold on
loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[0.4422674,0.2235419,0.1121385,0.0561332,0.0280793],'-','LineWidth',3);
hold on

loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[(9*9*9)^(-1/3),(17*17*17)^(-1/3),(33*33*33)^(-1/3) (65*65*65)^(-1/3),(129*129*129)^(-1/3)],'-','LineWidth',3);

legend('|e|_A','\eta_{Q_2(h)}','\eta_{Q^r_2(h)}','\eta_{Q_1(h/2)}','\eta_{Q^r_1(h/2)}','dof^{-1/3}')
xlabel('dof')
ylabel('error')
grid on
set(gca,'FontSize',20)

%------ cube domain tricubic solution (test problem 13)
figure(13)

loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[1.4027758,0.7002514,0.3499770,0.1749698,0.0880972],'-','LineWidth',3);
hold on

loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[3.2480763,1.2513863,0.5035018,0.2159251,0.0982107],'-','LineWidth',3);
hold on
loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[1.4958679,0.6989984,0.3340088,0.1627508,0.0802863],'-','LineWidth',3);
hold on
loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[2.2652107,0.9508667,0.4169989,0.1918936,0.0915120],'-','LineWidth',3);
hold on
loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[1.2930084,0.6237034,0.3037690,0.1495496,0.0741513],'-','LineWidth',3);
hold on

loglog([9*9*9,17*17*17,33*33*33 65*65*65 129*129*129 ],[(9*9*9)^(-1/3),(17*17*17)^(-1/3),(33*33*33)^(-1/3) (65*65*65)^(-1/3),(129*129*129)^(-1/3)],'-','LineWidth',3);

legend('|e|_{H^1}','\eta_{Q_2(h)}','\eta_{Q^r_2(h)}','\eta_{Q_1(h/2)}','\eta_{Q^r_1(h/2)}','dof^{-1/3}')
xlabel('dof')
ylabel('error')
grid on
set(gca,'FontSize',20)

